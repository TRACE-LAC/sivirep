---
title: "Reporte Automatizado de Circulación Viral"
date: '2023-03-01'
output:
  pdf_document: 
    number_sections: true
  html_document:
    number_sections: true
  word_document: 
    number_sections: true
header-includes:
- \usepackage{fancyhdr}
---

```{r setup, echo=FALSE, error=FALSE, fig.height=5, fig.width=5, warning=FALSE, include = FALSE, message= FALSE}
knitr::opts_chunk$set(echo = TRUE)
#remotes::install_github("epiverse-trace/sivirep", ref = "dev")

rm(list = ls())

library(sivirep)
library(dplyr) 
library(ggplot2) 
source("report_viral.R", local = knitr::knit_global())
```

\pagenumbering{gobble}
\pagenumbering{arabic}

# Virus respiratorios

Durante 2022, el Laboratorio de Salud Pública (LSP) continúa apoyando la vigilancia de la infección respiratoria aguda en Bogotá, mediante el procesamiento de muestras remitidas por instituciones centinela de los eventos: Enfermedad Similar a Influenza (ESI) que son pacientes ambulatorios, de pacientes hospitalizados por Infección Respiratoria Aguda Grave (IRAG) y de IRAG inusitado que se presente en cualquier institución de la ciudad. 

Las muestras previamente son procesadas por RT-PCR para SARS-CoV-2 y después continúan 
su análisis con: inmunofluorescencia y reacción en cadena de la polimerasa con transcriptasa 
inversa (RT-PCR) para el diagnóstico de los principales agentes a los que se les atribuye el IRAG.

Para esta semana, por grupo de edad, el 74.8 % de pacientes positivos para virus respiratorios 
diferentes al SARS-CoV-2 en 2022 corresponden a la población de menores de 5 años (figura 1) 
y si se incluye al SARS-CoV-2 los menores corresponden al 3.8 % (figura 2)

```{r disease_data, echo=FALSE, error=FALSE, fig.height=5, fig.width=8, warning=FALSE, include=TRUE, message=FALSE}

data <- import_data_viral_circulation(report_data = c("1-7 AGOSTO_2022.xlsx", "8-14 AGOSTO_2022.xlsx", "18 JULIO-24 JULIO_2022.xlsx", "25-31 JULIO_2022.xlsx"))
data <- clean_viral_circulation_data(data)
data <- generate_age_categories(data)
viruses_by_age_group <- get_distribution_by_age_group(report_data = data)
plot_distribution_by_age_group(viruses_by_age_group)

```
**Figura 1.** Distribución porcentual de virus respiratorios por grupo de edad, 
Laboratorio de Salud Pública Bogotá.

En la figura 1 se presenta el consolidado de los virus respiratorios por los diferentes grupos de edad. En los niños menores de 2 años las mayores frecuencias son de casos de virus: virus 
sincicial respiratorio (VSR) (28%), de rinovirus (23 %), y de adenovirus (21 %); para los niños entre 2 y 4 años se presentan casos de VSR (23 %), rinovirus (22 %), bocavirus (11 %) y adenovirus (23 %).

```{r distribution_not, echo=FALSE, error=FALSE, fig.height=5, fig.width=10, warning=FALSE, include=TRUE, message=FALSE}

generate_distribution_by_age_and_sars();

```
**Figura 2.**  Distribución porcentual de virus respiratorios y SARS CoV 2 por grupo de edad, 
Laboratorio de Salud Pública Bogotá.
\pagenumbering{arabic}

Al incluir el virus de SARS-CoV-2 en la cuenta de los virus respiratorios, se observa que, en 
los menores de 2 años predomina el SARS-CoV-2 (25 %), VSR (21 %), rinovirus (17 %). En el grupo de 2 a 4 años, SARS-CoV-2 (17 %), VSR (19 %), rinovirus (18 %), bocavirus y adenovirus (9 %) y (19 %) respectivamente. A continuación, se presenta la circulación acumulada de los virus respiratorios de forma desagregada por tipo de vigilancia, según grupo de edad (figura 3). También se ha incluido al SARS-CoV-2.

## Distribución de virus respiratorios en casos de ESI, según grupos de edad. Bogotá

```{r distribution_cg, echo=FALSE, error=FALSE, fig.height=5, fig.width=10, warning=FALSE, include=TRUE, message=FALSE}
generate_distribution_by_age_and_esi();
```

## Distribución de virus respiratorios en casos de IRA Grave, según grupos de edad. Bogotá

```{r distribution_epiweek, echo=FALSE, error=FALSE, fig.height=5, fig.width=10, warning=FALSE, include=TRUE, message=FALSE}

generate_distribution_by_age_and_ira();
```



## Distribución de virus respiratorios en casos de IRAG Inusitado, según grupos de edad. Bogotá

```{r distribution_age_d, echo=FALSE, error=FALSE, fig.height=5, fig.width=10, warning=FALSE, include=TRUE, message=FALSE}
generate_distribution_by_age_and_irag_inusitado();
```


